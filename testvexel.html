<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Paradigm Shift</title>
    
    <!-- Typography: Uni Sans -->
    <link href="https://fonts.cdnfonts.com/css/uni-sans" rel="stylesheet">

    <style>
        :root {
            --bg-color: #000000;
            --gummy-pink: rgba(236, 64, 122, 0.4);
            --sugar-white: rgba(255, 255, 255, 0.95);
            --accent-green: #55efc4;
        }

        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: var(--bg-color); 
            font-family: 'Uni Sans', sans-serif; 
            font-weight: 100; 
            touch-action: none;
            letter-spacing: 1px; 
        }

        /* --- INTRO ANIMATION --- */
        #intro-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #1a0033; 
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            animation: fadeOutIntro 1s ease-in-out forwards;
            animation-delay: 3.5s; 
        }

        .intro-title {
            color: #ffffff;
            font-size: 10vw; 
            font-weight: 100;
            text-align: center;
            line-height: 0.9;
            opacity: 0;
            animation: cinematicText 3s cubic-bezier(0.25, 1, 0.5, 1) forwards;
            animation-delay: 0.5s;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }

        @keyframes cinematicText {
            0% {
                opacity: 0;
                letter-spacing: -10px;
                transform: scale(0.95);
                filter: blur(10px);
            }
            100% {
                opacity: 1;
                letter-spacing: 5px; 
                transform: scale(1);
                filter: blur(0px);
            }
        }

        @keyframes fadeOutIntro {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }

        /* --- 1. CANVAS DYNAMICS --- */
        #syrup-bg {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
            background: #000000;
        }
        
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(50px);
            opacity: 0.6;
            animation: morph 10s infinite alternate ease-in-out;
        }
        .blob:nth-child(1) { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #ff9f43; animation-duration: 12s; }
        .blob:nth-child(2) { bottom: -20%; right: -10%; width: 60vw; height: 60vw; background: #ff5252; animation-duration: 15s; }
        .blob:nth-child(3) { top: 40%; left: 40%; width: 40vw; height: 40vw; background: #ffcccc; opacity: 0.3; animation-duration: 9s; }

        @keyframes morph {
            0% { transform: translate(0, 0) scale(1); border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
            50% { transform: translate(20px, -20px) scale(1.1); border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
            100% { transform: translate(-20px, 20px) scale(0.9); border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
        }

        /* --- 2. UI SURFACE --- */
        #ui {
            position: absolute;
            bottom: 50px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            pointer-events: none;
            z-index: 10;
            opacity: 0; 
            transition: opacity 1s ease-in;
        }

        .gummy-panel {
            background: var(--gummy-pink);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            padding: 12.5px 20px;
            text-align: center;
            box-shadow: 
                inset 0 0 15px rgba(255,255,255,0.2), 
                0 15px 35px rgba(199, 21, 133, 0.25);
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: auto;
            min-width: 140px; 
        }

        .gummy-panel:active {
            transform: scale(0.95);
        }

        #level-indicator {
            position: absolute;
            top: 30px;
            left: 30px;
            color: white;
            font-size: 0.9rem;
            font-weight: 100;
            letter-spacing: 2px;
            pointer-events: none;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            opacity: 0; 
            transition: opacity 1s ease-in;
        }

        h1#object-name { 
            margin: 0; 
            font-size: 0.9rem; 
            font-weight: 100; 
            color: #fff;
            letter-spacing: 1px;
            text-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
            line-height: 1.2;
            text-transform: uppercase; 
        }

        /* Progress Bar */
        #sync-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 240px;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 5;
        }
        #sync-bar {
            width: 0%;
            height: 100%;
            background: var(--accent-green);
            background: linear-gradient(90deg, #55efc4, #00b894);
            box-shadow: 0 0 10px var(--accent-green);
            border-radius: 10px;
            transition: width 0.1s linear;
        }
        
        canvas { display: block; cursor: grab; }
        canvas:active { cursor: grabbing; }
    </style>
</head>
<body>

    <!-- Intro Animation Container -->
    <div id="intro-overlay">
        <div class="intro-title">PARADIGM<br>SHIFT</div>
    </div>

    <div id="syrup-bg">
        <div class="blob"></div>
        <div class="blob"></div>
        <div class="blob"></div>
    </div>

    <div id="level-indicator">LEVEL 1</div>
    
    <div id="sync-container">
        <div id="sync-bar"></div>
    </div>

    <div id="ui">
        <div class="gummy-panel">
            <h1 id="object-name">Find the...</h1>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';

        // --- 1. RANDOM MUSIC ENGINE ---
        
        const songLibrary = [
            {
                title: "Paradigm Shift (Anamorphic Assembly) â€” S",
                // 1. Go to https://base64.guru/converter/encode/audio/mp3
                // 2. Upload your MP3.
                // 3. Paste the huge string inside these quotes:
                src: "" 
            },
            // ADD MORE SONGS HERE:
            // { title: "Song 2", src: "data:audio/mp3;base64,..." },
            // { title: "Song 3", src: "data:audio/mp3;base64,..." }
        ];

        let currentAudio = null;
        let musicStarted = false;

        function initMusic() {
            if (musicStarted || songLibrary.length === 0) return;
            
            // Check if user has pasted a song
            if (songLibrary[0].src === "") {
                console.log("Music Engine: No Base64 string found. Please paste your song data.");
                return;
            }

            musicStarted = true;
            playRandomSong();
        }

        function playRandomSong() {
            // Stop current if playing
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }

            // Pick random song
            const randomIndex = Math.floor(Math.random() * songLibrary.length);
            const song = songLibrary[randomIndex];
            
            console.log("Playing:", song.title);

            currentAudio = new Audio(song.src);
            currentAudio.volume = 0.5; 
            
            // Auto-play next song when this one ends
            currentAudio.onended = () => {
                playRandomSong();
            };

            // Handle play promise (browsers might block if not interactive)
            currentAudio.play().catch(e => console.log("Audio play blocked, waiting for interaction:", e));
        }


        // --- 2. ENGINE SETUP ---
        const scene = new THREE.Scene();
        scene.background = null; 

        const width = window.innerWidth;
        const height = window.innerHeight;
        const aspect = width / height;
        const d = 10; 
        
        const camera = new THREE.OrthographicCamera(-d * aspect, d * aspect, d, -d, 0.1, 1000);
        camera.position.set(0, 0, 20); 
        camera.lookAt(0, 0, 0);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(width, height);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.body.appendChild(renderer.domElement);

        // --- 3. LIGHTING ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const mainLight = new THREE.DirectionalLight(0xffffff, 1.2);
        mainLight.position.set(5, 10, 10);
        scene.add(mainLight);
        
        const rimLight = new THREE.DirectionalLight(0xffffff, 1.0); 
        rimLight.position.set(-5, 5, -5);
        scene.add(rimLight);
        
        const sparkleLight = new THREE.PointLight(0xffffff, 1, 100);
        sparkleLight.position.set(0, 0, 10);
        scene.add(sparkleLight);

        // Flare FX
